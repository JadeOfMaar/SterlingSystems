@PART[strl-rad-wraps?-*]:NEEDS[SystemHeat]
{
	refECReq = #$/MODULE[ModuleActiveRadiator]/RESOURCE/rate$
	
	!MODULE[ModuleAnimateHeat] {}
	MODULE
	{
		name = ModuleSystemHeatColorAnimator
		moduleID = heat
		useRate = false
		animRate = 1
		shaderProperty = _EmissiveColor
		toggleInEditor = false
		toggleInFlight = false
		redCurve
		{
			key = 0 1
			key = 1 1
		}
		greenCurve
		{
			key = 0 1
			key = 1 1
		}
		blueCurve
		{
			key = 0 1
			key = 1 1
		}
		alphaCurve
		{
			key = 0 0
			key = 1 1
		}
	}
	
	MODULE
	{
		name = ModuleSystemHeat
		volume = #$/refArea$
		@volume *= 0.01
		moduleID = default
		iconName = Icon_Radiator
		ignoreTemperature = true
	}
	@MODULE[ModuleActiveRadiator]
	{
		@name = ModuleSystemHeatRadiator
		moduleID = radiator
		// ModuleSystemHeat instance to link to
		systemHeatModuleID = default
		scalarModuleID = heat
		maxTempAnimation = 1400

		// option: use deterministic temperatures
		// Power radiated per temperature
		temperatureCurve
		{
			key = 0 0
			key = #$/refTemp$ $/refPower$
		}
		// area for convection
		convectiveArea = #$/refArea$
	}
}

@PART[strl-rad-wraps?-125]:NEEDS[B9PartSwitch,SystemHeat]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[Height]]
	{
		@SUBTYPE[2x]
		{
			!MODULE {}
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleSystemHeatRadiator
				}
				DATA
				{
					temperatureCurve
					{
						key = 0 0
						key = #$/refTemp$ $/refPower2$
					}
					RESOURCE
					{
						name = ElectricCharge
						rate = #$/refECReq$
						@rate *= 2
					}
					convectiveArea = #$/refArea$
					@convectiveArea *= 2
				}
			}
		}
		@SUBTYPE[4x]
		{
			!MODULE {}
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleSystemHeatRadiator
				}
				DATA
				{
					temperatureCurve
					{
						key = 0 0
						key = #$/refTemp$ $/refPower4$
					}
					RESOURCE
					{
						name = ElectricCharge
						rate = #$/refECReq$
						@rate *= 4
					}
					convectiveArea = #$/refArea$
					@convectiveArea *= 4
				}
			}
		}
		@SUBTYPE[6x]
		{
			!MODULE {}
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleSystemHeatRadiator
				}
				DATA
				{
					temperatureCurve
					{
						key = 0 0
						key = #$/refTemp$ $/refPower6$
					}
					RESOURCE
					{
						name = ElectricCharge
						rate = #$/refECReq$
						@rate *= 6
					}
					convectiveArea = #$/refArea$
					@convectiveArea *= 6
				}
			}
		}
		@SUBTYPE[8x]
		{
			!MODULE {}
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleSystemHeatRadiator
				}
				DATA
				{
					temperatureCurve
					{
						key = 0 0
						key = #$/refTemp$ $/refPower8$
					}
					RESOURCE
					{
						name = ElectricCharge
						rate = #$/refECReq$
						@rate *= 8
					}
					convectiveArea = #$/refArea$
					@convectiveArea *= 8
				}
			}
		}
	}
}

@PART[strl-rad-wraps?-250|strl-rad-wraps?-375|strl-rad-wraps?-500]:NEEDS[B9PartSwitch,SystemHeat]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[Height]]
	{
		@SUBTYPE[2x]
		{
			!MODULE {}
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleSystemHeatRadiator
				}
				DATA
				{
					temperatureCurve
					{
						key = 0 0
						key = #$/refTemp$ $/refPower2$
					}
					RESOURCE
					{
						name = ElectricCharge
						rate = #$/refECReq$
						@rate *= 2
					}
					convectiveArea = #$/refArea$
					@convectiveArea *= 2
				}
			}
		}
		@SUBTYPE[3x]
		{
			!MODULE {}
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleSystemHeatRadiator
				}
				DATA
				{
					temperatureCurve
					{
						key = 0 0
						key = #$/refTemp$ $/refPower3$
					}
					RESOURCE
					{
						name = ElectricCharge
						rate = #$/refECReq$
						@rate *= 3
					}
					convectiveArea = #$/refArea$
					@convectiveArea *= 3
				}
			}
		}
		@SUBTYPE[4x]
		{
			!MODULE {}
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleSystemHeatRadiator
				}
				DATA
				{
					temperatureCurve
					{
						key = 0 0
						key = #$/refTemp$ $/refPower4$
					}
					RESOURCE
					{
						name = ElectricCharge
						rate = #$/refECReq$
						@rate *= 4
					}
					convectiveArea = #$/refArea$
					@convectiveArea *= 4
				}
			}
		}
	}
}

@PART[strl-rad-wraps?-mk2]:NEEDS[B9PartSwitch,SystemHeat]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[Height]]
	{
		@SUBTYPE[2x]
		{
			!MODULE {}
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleSystemHeatRadiator
				}
				DATA
				{
					temperatureCurve
					{
						key = 0 0
						key = #$/refTemp$ $/refPower2$
					}
					RESOURCE
					{
						name = ElectricCharge
						rate = #$/refECReq$
						@rate *= 2
					}
					convectiveArea = #$/refArea$
					@convectiveArea *= 2
				}
			}
		}
		@SUBTYPE[4x]
		{
			!MODULE {}
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleSystemHeatRadiator
				}
				DATA
				{
					temperatureCurve
					{
						key = 0 0
						key = #$/refTemp$ $/refPower4$
					}
					RESOURCE
					{
						name = ElectricCharge
						rate = #$/refECReq$
						@rate *= 4
					}
					convectiveArea = #$/refArea$
					@convectiveArea *= 4
				}
			}
		}
		@SUBTYPE[8x]
		{
			!MODULE {}
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleSystemHeatRadiator
				}
				DATA
				{
					temperatureCurve
					{
						key = 0 0
						key = #$/refTemp$ $/refPower8$
					}
					RESOURCE
					{
						name = ElectricCharge
						rate = #$/refECReq$
						@rate *= 8
					}
					convectiveArea = #$/refArea$
					@convectiveArea *= 8
				}
			}
		}
	}
}

@PART[strl-rad-wraps?-mk3]:NEEDS[B9PartSwitch,SystemHeat]
{
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[Height]]
	{
		@SUBTYPE[2x]
		{
			!MODULE {}
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleSystemHeatRadiator
				}
				DATA
				{
					temperatureCurve
					{
						key = 0 0
						key = #$/refTemp$ $/refPower2$
					}
					RESOURCE
					{
						name = ElectricCharge
						rate = #$/refECReq$
						@rate *= 2
					}
					convectiveArea = #$/refArea$
					@convectiveArea *= 2
				}
			}
		}
		@SUBTYPE[3x]
		{
			!MODULE {}
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleSystemHeatRadiator
				}
				DATA
				{
					temperatureCurve
					{
						key = 0 0
						key = #$/refTemp$ $/refPower3$
					}
					RESOURCE
					{
						name = ElectricCharge
						rate = #$/refECReq$
						@rate *= 3
					}
					convectiveArea = #$/refArea$
					@convectiveArea *= 3
				}
			}
		}
		@SUBTYPE[4x]
		{
			!MODULE {}
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleSystemHeatRadiator
				}
				DATA
				{
					temperatureCurve
					{
						key = 0 0
						key = #$/refTemp$ $/refPower4$
					}
					RESOURCE
					{
						name = ElectricCharge
						rate = #$/refECReq$
						@rate *= 4
					}
					convectiveArea = #$/refArea$
					@convectiveArea *= 4
				}
			}
		}
		@SUBTYPE[8x]
		{
			!MODULE {}
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleSystemHeatRadiator
				}
				DATA
				{
					temperatureCurve
					{
						key = 0 0
						key = #$/refTemp$ $/refPower8$
					}
					RESOURCE
					{
						name = ElectricCharge
						rate = #$/refECReq$
						@rate *= 8
					}
					convectiveArea = #$/refArea$
					@convectiveArea *= 8
				}
			}
		}
	}
}

@PART[strl-rad-sink-*]:NEEDS[SystemHeat]
{
	!MODULE[ModuleActiveRadiator] {}
	MODULE
	{
		name = ModuleSystemHeat
		// Cubic metres
		volume = #$/refVolume$
		@volume *= 6.12
		moduleID = sink
		iconName = Icon_Tank
		ignoreTemperature = true
	}
}